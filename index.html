<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>CLG Star Awards 2025 ‚Äì Registration</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      :root {
        --midnight-blue: #071427;
        --gold: #f3c773;
        --gold-soft: #e4b861;
        --text-soft: #f8f3e6;
      }

      * {
        box-sizing: border-box;
      }

      html {
        -webkit-text-size-adjust: 100%;
      }

      body {
        margin: 0;
        min-height: 100vh;
        background: radial-gradient(
          circle at top,
          #15294b 0,
          var(--midnight-blue) 55%,
          #020712 100%
        );
        color: var(--text-soft);
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        display: flex;
        justify-content: center;
        padding: 32px 16px 40px;
      }

      .card {
        width: 100%;
        max-width: 520px;
        padding: 26px 22px 24px;
        background: linear-gradient(
          145deg,
          rgba(255, 255, 255, 0.04),
          rgba(0, 0, 0, 0.4)
        );
        border-radius: 18px;
        border: 1px solid rgba(243, 199, 115, 0.45);
        box-shadow:
          0 18px 40px rgba(0, 0, 0, 0.85),
          0 0 0 1px rgba(0, 0, 0, 0.8);
        position: relative;
        overflow: hidden;
      }

      .card::before {
        content: "";
        position: absolute;
        inset: 0;
        background-image:
          radial-gradient(
            circle at 10% 20%,
            rgba(255, 255, 255, 0.22) 0,
            transparent 40%
          ),
          radial-gradient(
            circle at 80% 10%,
            rgba(255, 255, 255, 0.16) 0,
            transparent 45%
          ),
          radial-gradient(
            circle at 70% 80%,
            rgba(255, 255, 255, 0.09) 0,
            transparent 50%
          );
        opacity: 0.18;
        pointer-events: none;
      }

      .card-inner {
        position: relative;
        z-index: 1;
      }

      .frame-line {
        position: absolute;
        inset: 10px;
        border-radius: 16px;
        border: 1px solid rgba(243, 199, 115, 0.35);
        opacity: 0.9;
        pointer-events: none;
      }

      header {
        text-align: center;
        padding-bottom: 14px;
      }

      h1 {
        margin: 0;
        font-size: clamp(1.8rem, 6vw, 2.6rem);
        letter-spacing: 0.2em;
        text-transform: uppercase;
        color: var(--gold);
      }

      .event-tagline-main {
        margin-top: 8px;
        font-size: clamp(0.9rem, 3vw, 1.2rem);
        letter-spacing: 0.22em;
        text-transform: uppercase;
        color: rgba(243, 199, 115, 0.95);
      }

      .event-title {
        margin-top: 14px;
        font-size: clamp(0.9rem, 2.5vw, 1.05rem);
        letter-spacing: 0.18em;
        text-transform: uppercase;
        color: rgba(248, 243, 230, 0.9);
      }

      .event-date {
        margin-top: 6px;
        font-size: clamp(0.82rem, 2.2vw, 1rem);
        letter-spacing: 0.16em;
        text-transform: uppercase;
        color: rgba(248, 243, 230, 0.8);
      }

      .divider {
        margin: 20px auto;
        height: 1px;
        width: 80%;
        background: linear-gradient(
          to right,
          transparent,
          rgba(243, 199, 115, 0.8),
          transparent
        );
      }

      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        font-size: clamp(0.86rem, 2.4vw, 1rem);
        letter-spacing: 0.06em;
        text-transform: uppercase;
        color: rgba(248, 243, 230, 0.9);
      }

      input[type="text"] {
        width: 100%;
        padding: 14px 16px;
        border-radius: 999px;
        border: 1px solid rgba(243, 199, 115, 0.7);
        background: rgba(3, 8, 18, 0.9);
        color: var(--text-soft);
        font-size: clamp(1rem, 3vw, 1.2rem);
        outline: none;
      }

      input[type="text"]::placeholder {
        color: rgba(248, 243, 230, 0.5);
      }

      button {
        margin-top: 14px;
        padding: 14px 26px;
        border-radius: 999px;
        border: none;
        cursor: pointer;
        font-size: clamp(1rem, 3.2vw, 1.2rem);
        font-weight: 600;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        background: linear-gradient(135deg, var(--gold), var(--gold-soft));
        color: #26140a;
        box-shadow: 0 9px 22px rgba(0, 0, 0, 0.8);
        width: 100%;
      }

      #result {
        margin-top: 16px;
        padding: 12px 14px;
        border-radius: 12px;
        font-size: clamp(0.9rem, 2.6vw, 1rem);
      }

      .success {
        background: rgba(17, 61, 45, 0.95);
        border: 1px solid rgba(166, 221, 188, 0.85);
        color: #e9f7ef;
      }

      .error {
        background: rgba(88, 16, 27, 0.96);
        border: 1px solid rgba(246, 97, 119, 0.8);
        color: #fdebed;
      }

      .footer-text {
        margin-top: 20px;
        text-align: center;
        font-size: clamp(0.82rem, 2.2vw, 0.95rem);
        color: rgba(248, 243, 230, 0.76);
      }

      @media (max-width: 480px) {
        body {
          padding: 24px 12px 32px;
        }
      }
    </style>
  </head>

  <body>
    <div class="card">
      <div class="frame-line"></div>

      <div class="card-inner">
        <header>
          <h1>CLG Star Awards 2025</h1>
          <div class="event-tagline-main">A Night of Brilliance</div>
          <div class="event-title">Event Registration</div>
          <div class="event-date">December 10, 2025</div>
        </header>

        <div class="divider"></div>

        <label for="guestInput">Search your name and select from the list</label>
        <input list="guestList" id="guestInput" type="text" autocomplete="off"
               placeholder="Start typing your full name" />

        <datalist id="guestList"></datalist>

        <button id="registerBtn">Register</button>

        <div id="result"></div>

        <div class="footer-text">
          If you can't find your name, please approach the registration desk for assistance.
        </div>
      </div>
    </div>

    <script>
      // üîó REPLACE THIS WITH YOUR OWN GAS WEB APP URL
      const GAS_WEB_APP_URL =
        'https://script.google.com/macros/s/AKfycbx4pMmCr50sgeu3LmHUFj7lEwTzu6-SsPYVkRuhVgUyOz0BfISsqTwPOQIAecReALzM/exec';

      const guestMap = {}; // name -> rowIndex

      async function loadGuestList() {
        const resultDiv = document.getElementById('result');
        resultDiv.textContent = '';
        resultDiv.className = '';

        try {
          const resp = await fetch(GAS_WEB_APP_URL + '?mode=guestList');
          if (!resp.ok) throw new Error('Network error loading guest list');

          const guests = await resp.json();
          const datalist = document.getElementById('guestList');
          datalist.innerHTML = '';

          guests.forEach((g) => {
            const opt = document.createElement('option');
            opt.value = g.name;
            datalist.appendChild(opt);
            guestMap[g.name] = g.rowIndex;
          });
        } catch (err) {
          resultDiv.className = 'error';
          resultDiv.textContent =
            'Unable to load guest list. Please approach the registration desk.';
          console.error(err);
        }
      }

      async function submitForm() {
        const input = document.getElementById('guestInput');
        const value = input.value.trim();
        const result = document.getElementById('result');

        result.textContent = '';
        result.className = '';

        if (!value) {
          result.className = 'error';
          result.textContent = 'Please enter your name.';
          return;
        }

        const rowIndex = guestMap[value];
        if (!rowIndex) {
          result.className = 'error';
          result.textContent =
            'Name not found. Please check the spelling or proceed to the registration desk for assistance.';
          return;
        }

        try {
          const resp = await fetch(GAS_WEB_APP_URL, {
            method: 'POST',
            headers: {
              // ‚ùó URL-encoded so there is NO CORS preflight
              'Content-Type':
                'application/x-www-form-urlencoded;charset=UTF-8',
            },
            body: 'rowIndex=' + encodeURIComponent(rowIndex),
          });

          if (!resp.ok) throw new Error('Network error during registration');

          const data = await resp.json();

          if (!data.success) {
            result.className = 'error';
            result.textContent =
              'There was an error registering you. Please approach the registration desk.';
            console.error(data);
            return;
          }

          input.value = '';
          result.className = 'success';

          let seatText = '';
          if (data.tableNo || data.tableName) {
            seatText =
              'Your assigned table is ' +
              (data.tableNo || '') +
              (data.tableName ? ' ‚Äì ' + data.tableName : '') +
              '.';
          } else {
            seatText =
              'Please proceed to the ushers for your assigned table.';
          }

          result.innerHTML =
            "<strong>You've successfully registered to the event!</strong><br>" +
            seatText;
        } catch (err) {
          result.className = 'error';
          result.textContent =
            'There was an error registering you. Please approach the registration desk.';
          console.error(err);
        }
      }

      document.addEventListener('DOMContentLoaded', () => {
        loadGuestList();
        document
          .getElementById('registerBtn')
          .addEventListener('click', submitForm);
      });
    </script>
  </body>
</html>
